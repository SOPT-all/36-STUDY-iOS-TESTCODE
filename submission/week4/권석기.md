# TDD 사이클(Red-Green-Refactor)
TDD를 수행하는 핵심적인 사이클로 Red-Green-Refactor의 단계를 점진적으로 거쳐나가며 코드이 품질을 향상시킨다.

## 실패하는 테스트 케이스 작성: Red
Red의 단계에서는 실패하는 테스트케이스를 작성한다. 기능의 요구사항이 아직 충족되지 않은 상태
아래의 테스트는 통과하지 못한다
```swift
func add(_ a: Int, _ b: Int) -> Int {
        return 0
    }

    func testAdd() throws {
        let sum = sut.add(2, 5)
        XCTAssertEqual(7, sum, "올바르지 않은 결과")
    }
```

## 테스트를 통과하는 최소한의 로직 구현: Green
테스트가 통고하나는 최소한의 로직을 작성한다. 이때는 로직이 동작만 하면 괜찮다. 가독성, 효율성등은 신경쓰지 않는다.
```swfit
    func add(_ a: Int, _ b: Int) -> Int {
        return 7
    }
```

## 코드 개선: Refactor
Green 단계에서 테스트가 모두 통과하는 경우 리팩터링의 단계
코드개선이 해당 단계에서 이루어짐(효율성, 네이밍, 구조 등)

```swift
func add(_ a: Int, _ b: Int) -> Int {
        return a + b
    }
```
기존의 하드코딩된 부분을 개선

# 비동기 테스트 XCTestExpectation

XCTestExpectation은 비동기 코드의 완료를 기다리고 테스트하는 기능이다.

```swift
func testAPI() {
    let expectation = XCTestExpectation(description: "서버 응답을 기다림")

    fetchDataFromServer { result in
        XCTAssertEqual(result, "success") 
        expectation.fulfill()             
    }

    wait(for: [expectation], timeout: 3.0)
}
```
- wait: 작업 완료시까지 최대 3초를 기다린다.
- fullfill() 메서드를 호출하면 작업이 완료되었음을 알린다.
